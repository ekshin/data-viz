---
title: "EUN SHIN DATA VISUALIZATION"
author: "Eun Kyong Shin"
date: "February 3, 2015"
output: pdf_document
---
##**TASK** <br>
The Nigerian Government has committed $1.2 billion USD to achieving the United Nations Millennium Development Goals. Matching grants are given to Local Government Areas (LGAs) for approved projects and programmes geared towards reducing poverty and improving education and health. To promote the use of data in the local planning process, a rigorous, geo-referenced, baseline facility inventory was conducted for the entire country. The objective was to collect data for all of Nigeria’s health, education and water facilities. The result is this online portal, the Nigeria MDG Information System (NMIS).

Using this rich dataset, we will assess a few key development statistics, previously unknowable.

- **[PART 1]** Go to this link to retrieve general metadata for Local Government Areas (LGAs) of Nigeria. LGAs are akin to counties in the U.S.Next, download the full NMIS dataset, and grab the [large] .csv file called “Health_Mopup_and_Baseline_NMIS_Facility.csv”. This contains every health facility in Nigeria.
- **[PART 2]** Produce a new data.frame with the following properties:From the NMIS Health Facilities Inventory, select all facilities located in the Southern zones of Nigeria.Incorporate LGA metadata into this new dataframe.
- **[PART 3]** Calculate the total number of full time nurses and doctors for all health facilities, by state. Compute per capita and per area values, as well.
Sort the resulting dataset by state population, in descending order.
Show the results!


##**SOLUTION**


For **PART 1** of the assignemnt,I downloaded the two data sets in my working directory. For **PART 2** I merged the two data files by the `unique_lga` variable. Then, to select all facilities located in the Southern zones of Nigeria, I made the subset of the data which I names as `newdata`. Also I omitted missing variables. 

```{r}
setwd("/Users/eunkyongshin/GitHub/data-viz/r")
lgas<-read.csv("lgas.csv")
nmis<- read.csv("Health_Mopup_and_Baseline_NMIS_Facility.csv")
data<-merge(nmis, lgas, by="unique_lga")
newdata<-subset(data, zone %in% c("South-South","Southeast","Southwest"))
summary(newdata$state)
```

For coding efficiency, I costomized value names. Also by creating new variable `nurse` I added up the `num_nurses_fulltime` and `num_nursemidwives_fulltime` to use it as the total number of full time nurses. 

```{r eval=FALSE}
newdata<-rename(newdata,c(num_nurses_fulltime="nurs"))
newdata<-rename(newdata,c(num_nursemidwives_fulltime="midw"))
newdata<-rename(newdata,c(num_doctors_fulltime="doctor"))
newdata<-rename(newdata,c(facility_name="facility"))
newdata<-rename(newdata,c(pop_2006="popu"))
newdata<-rename(newdata,c(area_sq_km="area"))
newdata$nurse<-newdata$nurs+newdata$midw
```

Next,in **PART 3** I created two subsets that willl merged as `statedata` at the end. The first subset, `mydata1` contains facilities only in the southern part of Nigeria, The `finaldata` contains informations of the total full time nurses and doctors for all health dacilities in the Southern Zones of Nigeria.  

```{r eval=FALSE}
myvars<-c("facility","nurse","doctor","state","zone","area","popu")
mydata<-newdata[myvars]
mydata<-na.omit(mydata) ## Omit missing variables
head(mydata)
```

![head(mydata)](/Users/eunkyongshin/GitHub/data-viz/r/headmydata1.png)  

Please note that my embedded {r} code had some issue in knitting, so I used {r eval=FALSE} to create the final html document. To show the result, I captured my console image and inserted as image file to the body.

To calculate total numer of full time nurses and doctors, I extracted `state`,`nurse`,`doctor` and created `statedata2`.

```{r eval=FALSE}
statedata1<-ddply(mydata,.(state),numcolwise(sum))
write.csv(statedata1, file="statedata1.csv")
states1<-read.csv("statedata1.csv")
newvars<-c("state","nurse","doctor")
statedata2<-states1[newvars]
head(statedata2)
```

![head(mydata)](/Users/eunkyongshin/GitHub/data-viz/r/head2.png)   

To calculate the sum of population and area data which are given at lga level upto the state level, I sumed up unique data points in `area` and `popu` in each state. `statedata6` contains population and area data at the state level. 

```{r eval=FALSE}
statedata3<-c("state","area","popu")
stateinfo<-mydata[statedata3]
stateinfo1<-unique(stateinfo)
statedata4<-ddply(stateinfo1,.(state),numcolwise(sum))
write.csv(statedata4, file="statedata4.csv")
statedata5<-read.csv("statedata4.csv")
newvars2<-c("state","area","popu")
statedata6<-statedata5[newvars2]
head(statedata6)
```

![head(mydata)](/Users/eunkyongshin/GitHub/data-viz/r/head3.png)   

Then, I merged `statedata2` and `statedata6` to generate final table. 

```{r eval=FALSE}
findata<-merge(statedata2, statedata6, by="state") ## merge docs/nurse data with state level data
head(findata)
```

![head(mydata)](/Users/eunkyongshin/GitHub/data-viz/r/head4.png)  

Then to calculate numbers of full time nurses and doctors per cap and per area, I created new varaibles `nursepc` (number of full time nurses per capita), `nursepa` (number of full time nurses per area), `doctorpc` (number of full time doctors per capita), and `doctorpa` (number of full time doctors per area). As requested in the assignment, I arranged my finaldata in descending order of population.  


```{r eval=FALSE}
findata$nursepc<-findata$nurse/findata$popu
findata$nursepa<-findata$nurse/findata$area
findata$doctorpc<-findata$doctor/findata$popu
findata$doctorpa<-findata$doctor/findata$area
findata
arrange(findata,desc(popu))
```

![head(mydata)](/Users/eunkyongshin/GitHub/data-viz/r/finaltable.png) 

```{r eval=FALSE}
write.csv(findata, file="findata.csv") ## save the final data
```


